<%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="utf-8"%>
<%@ include file="/static/jsp/taglibs.jsp"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8>
<title>角色管理</title>
<link rel="shortcut icon" href="${ctx}/static/src/images/favicon.ico">
<link rel="stylesheet" href="${ctx}/static/plugins/layui/css/layui.css" media="all" />
<link rel="stylesheet" href="${ctx}/static/plugins/font-awesome/css/font-awesome.min.css" media="all" />
<link rel="stylesheet" href="${ctx}/static/src/css/app.css" media="all" />
<link rel="stylesheet" href="${ctx}/static/src/css/themes/default.css" media="all" id="skin" kit-skin />
<link rel="stylesheet" href="${ctx}/static/plugins/ztree/css/bootstrapStyle/bootstrapStyle.css" media="all" id="skin" kit-skin />
	<style>
		.laytable-cell-checkbox{position:relative;top:5px;}
		.layui-btn-group{width:100%;text-align:center;position:absolute;bottom:10px;}
		#setting{position:relative;right:56px;}
		#back{position:relative;left:56px;background: #c2c2c2;}
	</style>
</head>

<body>
	
    <div class="admin-main">
			<div class="layui-field-box layui-form">
				<table id="role-lt" lay-filter="role" class="layui-hide layui-table">

				</table>
			</div>
    </div>
    
    <div class="container" id="authorize" style="display: none;">
		<ul id="treeDemo" class="ztree"></ul>
		<div class="layui-btn-group">
			<button id="setting" class="layui-btn layui-btn-sm setting">设置授权</button>
			<a id="back" href="${ctx}/roleList.do" class="layui-btn layui-btn-primary layui-btn-sm setting">返回角色列表</a>
		</div>
	</div>
</body>
	<script type="text/html" id="status">
		<!-- 这里的 checked 的状态只是演示 -->
		<input disable type="checkbox" name="lock" value="{{d.status}}" title="启用" lay-filter="lockDemo" {{ d.status==1 ? 'checked' : '' }}>
	</script>
	<script type="text/html" id="roleOper">
		<a class="layui-btn layui-btn-normal layui-btn-xs layui-input-treeselect" lay-event="authorize"><i class="layui-icon">&#xe63c;</i>授权</a>
		<a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit"><i class="layui-icon">&#xe639;</i>修改</a>
		<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del"><i class="layui-icon">&#xe639;</i>删除</a>
	</script>
	<script src="${ctx}/static/plugins/jquery-3.2.1.js"></script>
	<script src="${ctx}/static/plugins/layui/layui.js"></script>
	<script src="${ctx}/static/plugins/ztree/js/jquery.ztree.core.js"></script>
	<script src="${ctx}/static/plugins/ztree/js/jquery.ztree.excheck.js"></script>
	<script src="${ctx}/static/plugins/ztree/js/jquery.ztree.exedit.js"></script>
    <script>
        layui.use(['table','layer','form'], function() {
            var table = layui.table;
            var layer = layui.layer;
            var $ = layui.$;
            table.render({
            	elem:'#role-lt',
            	url:'${ctx}/roles.do',
            	request:{
            		pageName:'pageStart',
            		limitName:'pageSize',
            		limit:'5'
            	},
            	limit:[5,10,20,30,40],
            	response:{
            		statusName:'code',
            		statusCode:1,
            		msgName:'msg',
            		countName: 'count', //数据总数的字段名称，默认：count
            		dataName:'data'
            	},
            	page:true,
            	cols:[
            		[
						{
							field:'',
							title:'',
							type:'checkbox',
							align:'center',
							width:40,
						},
            			{
            				field:'id',
            				title:'ID',
            				align:'center',
            				width:60,
            			},
            			{
            				field:'name',
            				title:'角色名称',
            				align:'center',
            				width:140,
            			},
            			{
            				field:'description',
            				title:'描述',
            				align:'center',
            				width:280,
            			},
            			{
            				field:'status',
            				title:'状态',
            				align:'center',
            				width:200,
            				templet: '#status'
            			},
            			{
            				field:'createTime',
            				title:'创建日期',
            				align:'center',
            				width:180,
            			},
            			{
            				field:'oper',
            				title:'操作',
            				align:'center',
            				fixed:'right',
            				toolbar:'#roleOper'
            			}
            		]
            	]
            });
            
            table.on('tool(role)',function(data){
            	if(data.event=='authorize'){
            		layer.open({
            			type: 1,
        				title: "角色授权",
        				area: ['340px', '480px'],
        				shadeClose: false,
        				content: $("#authorize")
        				/* btn1: function (index) {
        					$.fn.zTree.init($("#treeDemo"), setting, nodes);
        				} */
            		})
            	}
            });
            
        });
    </script>
</html>